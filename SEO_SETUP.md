# SEO and Analytics Setup Guide

This guide explains how to set up SEO features, Google Analytics 4, and cookie consent for your Premier League Tracker website.

## Table of Contents

1. [Sitemap Setup](#sitemap-setup)
2. [Robots.txt Setup](#robotstxt-setup)
3. [Google Analytics 4 Setup](#google-analytics-4-setup)
4. [Cookie Consent](#cookie-consent)
5. [Environment Variables](#environment-variables)

## Sitemap Setup

The sitemap is automatically generated by Next.js at `/sitemap.xml`. The sitemap includes all public pages:

- `/` (Home)
- `/fixtures-results`
- `/standings`
- `/compare`
- `/top-scorers`

### Site URL Configuration

The sitemap is configured to use `https://premierleaguefixures.com` by default.

To override this (e.g., for staging environments), set the `NEXT_PUBLIC_SITE_URL` environment variable:

```typescript
// In app/sitemap.ts, the baseUrl uses:
const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://premierleaguefixures.com';
```

## Robots.txt Setup

The `robots.txt` file is located at `public/robots.txt` and is already configured with the correct domain.

### Current Configuration

- Allows all search engines to crawl all pages
- Blocks indexing of API routes (`/api/*`)
- Blocks indexing of internal Next.js files (`/_next/*`, `/sw.js`)

## Google Analytics 4 Setup

### Step 1: Create GA4 Property

1. Go to [Google Analytics](https://analytics.google.com/)
2. Create a new GA4 property (if you don't have one)
3. Get your Measurement ID (format: `G-XXXXXXXXXX`)

### Step 2: Set Environment Variable

Add the following to your `.env.local` file (for local development):

```env
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

For production (Netlify):

1. Go to your Netlify site dashboard
2. Navigate to **Site settings** → **Environment variables**
3. Add a new variable:
   - Key: `NEXT_PUBLIC_GA_MEASUREMENT_ID`
   - Value: `G-XXXXXXXXXX` (your actual Measurement ID)

### Step 3: Verify Installation

1. Deploy your site
2. Visit your website
3. Accept cookies in the consent banner
4. Check Google Analytics Real-Time reports to verify tracking is working

### How It Works

- GA4 only loads after the user accepts cookies (GDPR compliant)
- Page views are automatically tracked on route changes
- The tracking script is dynamically loaded only when consent is given

## Cookie Consent

The cookie consent banner is automatically displayed to users who haven't made a choice yet.

### Features

- **EU GDPR Compliant**: Only loads analytics after explicit consent
- **Persistent Choice**: User's preference is saved in localStorage
- **Non-intrusive**: Banner appears at the bottom of the screen
- **Accessible**: Includes proper ARIA labels

### User Experience

1. First-time visitors see the cookie banner after 1 second
2. Users can either:
   - **Accept All**: Enables Google Analytics tracking
   - **Reject**: Disables all tracking cookies
3. Choice is saved and banner won't appear again
4. If user accepts, the page reloads to initialize GA4

### Customization

To customize the cookie consent banner:

1. Edit `components/CookieConsent.tsx` for functionality
2. Edit `app/globals.css` (look for `.cookie-consent-*` classes) for styling

## Environment Variables

### Required for Production

Set this in your Netlify dashboard under **Site settings** → **Environment variables**:

```env
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

### Optional

- `NEXT_PUBLIC_SITE_URL`: Used in sitemap generation. If not set, defaults to `https://premierleaguefixures.com`.

## Verification Checklist

After setup, verify:

- [ ] Sitemap is accessible at `https://premierleaguefixures.com/sitemap.xml`
- [ ] Robots.txt is accessible at `https://premierleaguefixures.com/robots.txt`
- [ ] Robots.txt points to correct sitemap URL (`https://premierleaguefixures.com/sitemap.xml`)
- [ ] Cookie consent banner appears for new visitors
- [ ] GA4 tracking works after accepting cookies
- [ ] GA4 doesn't load when cookies are rejected
- [ ] `NEXT_PUBLIC_GA_MEASUREMENT_ID` environment variable is set in Netlify

## Testing Locally

1. Create `.env.local` file in project root:
```env
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

Note: The sitemap will use `http://localhost:3000` when `NEXT_PUBLIC_SITE_URL` is set locally.

2. Run `npm run dev`
3. Clear browser localStorage to test cookie consent
4. Check browser console for any errors
5. Verify GA4 script loads only after accepting cookies

## Troubleshooting

### GA4 Not Tracking

- Verify `NEXT_PUBLIC_GA_MEASUREMENT_ID` is set correctly
- Check that you've accepted cookies
- Verify the Measurement ID format (starts with `G-`)
- Check browser console for errors
- Use Google Tag Assistant browser extension

### Cookie Consent Not Appearing

- Clear browser localStorage: `localStorage.removeItem('cookie-consent')`
- Check browser console for errors
- Verify component is imported in `app/layout.tsx`

### Sitemap Not Found

- Ensure `app/sitemap.ts` exists
- Rebuild the site: `npm run build`
- Check that Next.js version supports sitemap generation (14+)

## Additional SEO Tips

1. **Submit Sitemap to Google Search Console**:
   - Go to [Google Search Console](https://search.google.com/search-console)
   - Add your property: `https://premierleaguefixures.com`
   - Submit your sitemap URL: `https://premierleaguefixures.com/sitemap.xml`

2. **Submit Sitemap to Bing Webmaster Tools**:
   - Go to [Bing Webmaster Tools](https://www.bing.com/webmasters)
   - Add your site: `https://premierleaguefixures.com`
   - Submit sitemap: `https://premierleaguefixures.com/sitemap.xml`

3. **Monitor Analytics**:
   - Check GA4 regularly for traffic insights
   - Monitor which pages are most popular
   - Track user behavior and engagement

4. **Improve Metadata**:
   - Update page-specific metadata in each page component
   - Add Open Graph images for better social sharing
   - Consider adding structured data (JSON-LD) for rich snippets
